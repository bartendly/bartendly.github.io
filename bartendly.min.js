document.addEventListener('DOMContentLoaded',()=>{document.body.classList.add('js-animate');const o=new IntersectionObserver(e=>{e.forEach(e=>{e.isIntersecting&&(e.target.classList.add('fade-in'),o.unobserve(e.target))})},{threshold:.15});document.querySelectorAll('section,.testimonial,.faq-item').forEach(e=>{o.observe(e)});const t=window.bartenders||[],a=[...t.sort(()=>.5-Math.random())];a.push({name:"And many others",bar:"Talented bartenders in Hong Kong",img:"more-bartenders",alt:"Group of bartenders celebrating in a bar"});const n=document.querySelector('.swiper-wrapper');n&&a.forEach(({name:e,bar:t,img:a,alt:o})=>{const r=document.createElement('div');r.className='swiper-slide',r.setAttribute('role','group'),r.setAttribute('aria-label',`${e} from ${t}`),"more-bartenders"===a?r.innerHTML='<a href="#book" class="promo-slide-link" aria-label="Book a bartender with Bartendly"><div class="text-slide"><div class="text-slide-content"><h3>And many other talented professional bartenders</h3><p>Try Bartendly today — no commission fees during our launch! <span class="cta-arrow" aria-hidden="true">→</span></p></div></div></a>':r.innerHTML=`<picture><source srcset="/images/${a}.webp" type="image/webp"><img src="/images/${a}.jpg" alt="${o}" title="${o}" loading="lazy" width="600" height="450"></picture><div class="carousel-info"><h3>${e}</h3><p>${t}</p></div>`,n.appendChild(r)}),window.addEventListener('load',()=>{new Swiper('.swiper',{loop:!0,autoplay:{delay:7e3,disableOnInteraction:!1},navigation:{nextEl:'.swiper-button-next',prevEl:'.swiper-button-prev'},pagination:{el:'.swiper-pagination',clickable:!0},slidesPerView:1,spaceBetween:20,breakpoints:{768:{slidesPerView:2},1024:{slidesPerView:3}}})}),flatpickr("#date",{dateFormat:"Y-m-d",allowInput:!0,clickOpens:!0,defaultDate:null,disableMobile:!0});const r=document.getElementById('contact-form'),s=document.getElementById('success-message');r&&r.addEventListener('submit',async e=>{e.preventDefault();const t=document.querySelector('input[name="email"]').value.trim(),a=document.querySelector('input[name="phone"]').value.trim(),n=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!t&&!a)return void alert('Please provide at least a phone number or an email address.');if(t&&!n.test(t))return void alert('Please enter a valid email address.');const o=r.querySelector('button[type="submit"]');o.disabled=!0,o.textContent='Sending...';const i=new FormData(r);try{const e=await fetch(r.action,{method:'POST',body:i,headers:{Accept:'application/json'}});e.ok?(r.reset(),r.style.display='none',s.style.display='block'):alert('Oops! Something went wrong while sending your message.')}catch(e){alert("Network error. Please try again later.")}finally{o.disabled=!1,o.textContent='Submit Event Request'}});const d=document.getElementById('ai-request-form'),c=document.getElementById('ai-success-message');d&&c&&d.addEventListener('submit',async e=>{e.preventDefault();const t=d.querySelector('input[name="ai-prompt"]').value.trim(),a=30,n=/\b(\d{1,2}[\/\-\. ]\d{1,2}([\/\-\. ]\d{2,4})?|\b(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?\s+\d{1,2}|\d{1,2}\s+(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?|\b(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?\s+\d{4})\b/i,o=n.test(t);if(!o)return void alert("Please include a date or approximate date for your event.");if(t.length<a)return void alert("Please provide a bit more detail about your request.");const i=d.querySelector('input[name="ai-contact"]').value.trim(),r=/^[^\s@]+@[^\s@]+\.[^\s@]+$/,s=/^(\+?\(?\d{1,4}\)?[\s\d\-]{5,})$/,l=r.test(i),u=s.test(i);if(!l&&!u)return void alert('Please enter a valid email or phone number.');const m=d.querySelector('button[type="submit"]');m.disabled=!0,m.textContent='Sending...';const f=new FormData(d);try{const e=await fetch(d.action,{method:'POST',body:f,headers:{Accept:'application/json'}});e.ok?(d.reset(),d.style.display='none',c.style.display='block'):alert('Oops! Something went wrong while sending your message.')}catch(e){alert('Network error. Please try again later.')}finally{m.disabled=!1,m.textContent='Get My Bartender'}});const l=document.getElementById('ai-prompt-form'),u=document.getElementById('ai-success-message');l&&u&&l.addEventListener('submit',async e=>{e.preventDefault();const t=l.querySelector('input[name="ai-message"]').value.trim(),a=50,n=/[^\s@]+@[^\s@]+\.[^\s@]+/,o=/(\+?\(?\d{1,4}\)?[\s\d\-]{5,})/,i=/\b(\d{1,2}[\/\-\. ]\d{1,2}([\/\-\. ]\d{2,4})?|\b(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?\s+\d{1,2}|\d{1,2}\s+(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?|\b(?:jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)[a-z]*\.?\s+\d{4})\b/i,r=n.test(t),s=o.test(t),d=i.test(t);if(!r&&!s)return void alert("Please include an email or phone number so we can contact you.");if(!d)return void alert("Please include a date or approximate date for your event.");if(t.length<a)return void alert("Please provide a bit more detail about your request.");const c=l.querySelector('button[type="submit"]');c.disabled=!0,c.textContent='Sending...';const m=new FormData(l);try{const e=await fetch(l.action,{method:'POST',body:m,headers:{Accept:'application/json'}});e.ok?(l.reset(),l.style.display='none',u.style.display='block'):alert("Oops! Something went wrong while sending your request.")}catch(e){alert("Network error. Please try again later.")}finally{c.disabled=!1,c.textContent='Get My Bartender'}});const m=document.getElementById('city-toggle'),f=document.getElementById('city-menu');m&&f&&(m.addEventListener('click',()=>{f.hasAttribute('hidden')?f.removeAttribute('hidden'):f.setAttribute('hidden','')}),document.addEventListener('click',e=>{const t=e.target.closest('#city-menu a');if(t)return;!m.contains(e.target)&&!f.contains(e.target)&&f.setAttribute('hidden','')}),document.querySelectorAll('#city-menu a').forEach(e=>{e.addEventListener('click',()=>{f.setAttribute('hidden','')})}));const b=document.querySelector(".globe-helper"),h=document.querySelector(".globe-wrapper"),g=document.getElementById('city-toggle');b&&h&&g&&(setTimeout(()=>{b.classList.add("show-once");const e=b.getBoundingClientRect();e.right>window.innerWidth&&(b.style.left='auto',b.style.right='0',b.style.transform='none'),setTimeout(()=>{b.classList.remove("show-once"),b.style.left='',b.style.right='',b.style.transform=''},3500)},2e3),g.addEventListener('click',()=>{b.classList.remove("show-once"),b.classList.add("hide-tooltip"),b.style.left='',b.style.right='',b.style.transform='',setTimeout(()=>{b.classList.remove("hide-tooltip")},500)}))});